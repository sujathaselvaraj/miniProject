jQuery(function($) {

    // Remove hardcoded loader overlays.
    $(".loader-overlay-temp").remove();

    if(!$("body").hasClass("noclass")) return;

    // Only show the animation once per session or 5 days, whichever is earlier.
    var cookie = $.cookie("preloader");
    var now = +new Date;
    var timeout = 5 * 24 * 60 * 60 * 1000;
    if(!cookie || (+cookie - now) > timeout) {
        $.cookie("preloader", now);
        start();
    } else {
        // setTimeout(function() {
        if(typeof revapi7 != 'undefined') {
            $("body").on("scriptsloaded", function() {
                revapi7.revstart();
            });
        }
        // }, 500);
    }

    function start() {
        log("start");
        var $leftOverlay = $("<div>")
                .addClass("loader-overlay left")
                .appendTo(document.body);
        var $rightOverlay = $("<div>")
                .addClass("loader-overlay right")
                .appendTo(document.body);
        // Remove hardcoded loader overlays.
        $(".loader-overlay-temp").remove();
        $(document.body).height("100%").css("overflow", "hidden");
        disableScroll();
        startBarAnimation(function() {
            waitFor(1000, function() {
                if(typeof revapi7 != 'undefined') {
                    revapi7.revstart();
                }
                slideUpOverlay(function() {
                    $(document.body).css("overflow", "auto");
                    enableScroll();
                });
            });
        });

        function startBarAnimation(done) {
            var $top = $("<div>").addClass("loader-line top").height(1200).appendTo(document.body);
            var $right = $("<div>").addClass("loader-line right").width(3000).appendTo(document.body);
            var $bottom = $("<div>").addClass("loader-line bottom").height(1200).appendTo(document.body);
            var $left = $("<div>").addClass("loader-line left").width(3000).appendTo(document.body);
            var $progress = $("<div>").addClass("loader-progress").appendTo(document.body);

            // tick(0, 1 + ~~(Math.random() * 10));
            tick(0, 2);

            function tick(prev, now) {
                if (now > 100) now = 100;

                var totalDuration = 350;
                var per = totalDuration / (now - prev);
                var durations = {
                    top: per * (clamped(now) - clamped(prev)),
                    right: per * (clamped(now - 25) - clamped(prev - 25)),
                    bottom: per * (clamped(now - 50) - clamped(prev - 50)),
                    left: per * (clamped(now - 75) - clamped(prev - 75))
                };

                setTimeout(function () {
                    $progress.text(now + "%");
                }, 150);

                $top.animate({
                    width: clamped(now) * 4 + "%"
                }, durations.top).queue(function (next) {
                    $right.animate({
                        height: clamped(now - 25) * 4 + "%"
                    }, durations.right, next);
                }).queue(function (next) {
                    $bottom.animate({
                        width: clamped(now - 50) * 4 + "%"
                    }, durations.bottom, next);
                }).queue(function (next) {
                    $left.animate({
                        height: clamped(now - 75) * 4 + "%"
                    }, durations.left, next);
                }).queue(function (next) {
                    if (now >= 100) {
                        setTimeout(function () {
                            $top.add($right).add($bottom).add($left).add($progress).fadeOut(800).promise().done(done);
                        }, 800);
                    } else {
                        setTimeout(function () {
                            // tick(now, now + 5 + ~~ (Math.random() * 15));
                            tick(now, now + 15);
                        }, 800);
                    }
                    next();
                });

                function clamped(n) {
                    return n < 0 ? 0 : (n > 25 ? 25 : n);
                }
            }

        }

        function waitFor(ms, done) {
            // log("waitFor");
            setTimeout(done, ms);
        }

        function slideUpOverlay(done) {
            $leftOverlay.add($rightOverlay).slideUp().promise().done(done);
        }

        function log(what) {
            if(console.log)
                console.log(what);
        }
    }

    // http://stackoverflow.com/questions/4770025/how-to-disable-scrolling-temporarily
    // left: 37, up: 38, right: 39, down: 40,
    // spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
    var keys = {37: 1, 38: 1, 39: 1, 40: 1};

    function preventDefault(e) {
        e = e || window.event;
        if (e.preventDefault)
            e.preventDefault();
        e.returnValue = false;
    }

    function preventDefaultForScrollKeys(e) {
        if (keys[e.keyCode]) {
            preventDefault(e);
            return false;
        }
    }

    function disableScroll() {
        if (window.addEventListener) // older FF
            window.addEventListener('DOMMouseScroll', preventDefault, false);
        window.onwheel = preventDefault; // modern standard
        window.onmousewheel = document.onmousewheel = preventDefault; // older browsers, IE
        window.ontouchmove  = preventDefault; // mobile
        document.onkeydown  = preventDefaultForScrollKeys;
    }

    function enableScroll() {
        if (window.removeEventListener)
            window.removeEventListener('DOMMouseScroll', preventDefault, false);
        window.onmousewheel = document.onmousewheel = null;
        window.onwheel = null;
        window.ontouchmove = null;
        document.onkeydown = null;
    }
});

jQuery(function($) {
    $.fn.rippleButton = function () {
        this.on("click", function (event) {
            var $this = $(this);
            $this.css("overflow", "hidden");
            $this.css("position", "relative");
            if ($this.find(".ripple-circle").length == 0) {
                $this.prepend($("<span>").addClass("ripple-circle"));
            }
            var $circle = $this.find(".ripple-circle");
            $circle.removeClass("animation");
            var radius = Math.max($this.outerWidth(), $this.outerHeight());
            $circle.css({
                height: radius,
                width: radius
            });
            var x = event.pageX - $this.offset().left - radius / 2;
            var y = event.pageY - $this.offset().top - radius / 2;
            $circle.css({
                left: x + 'px',
                top: y + 'px'
            }).addClass("animation");
        });
    };

    $(".ripple-button, input.gform_button").rippleButton();
});

jQuery(function($) {
	var brk = 106;
    var $window = $(window);
    var $logos = $(".mk-sticky-logo").parent();
    var $extra = $("#mk-logo-extra");
    var prev = 0;
    $window.scroll(function() {
        var now = $window.scrollTop();
        // console.log([prev, now]);
        if(prev < brk && now >= brk) {
            // console.log("fadeOut");
            $logos.velocity("finish").velocity("transition.fadeOut");
            $extra.find(".letter").show().velocity("finish").velocity("transition.fadeIn")
        } else if(prev >= brk && now < brk) {
            // console.log("fadeIn");
            $logos.velocity("finish").velocity("transition.fadeIn");
            $extra.find(".letter").show().velocity("finish").velocity("transition.fadeOut")
        }
        prev = now;
    });
});

jQuery(function($) {
    var $window = $(window);
    var $extra = $("#mk-logo-extra");
    var $container = $(".mk-sticky-logo").parent();
    var options = {
        duration: 650,
        stagger: 75
    };
    $container.mouseenter(function() {
        if($window.scrollTop() >= 125 || $window.width() < 960) return;
        // console.log("mouseenter");
        $container.velocity("transition.fadeOut");
        $extra.find(".letter").velocity("stop").velocity("transition.slideUpIn", options);
    });

    $extra.mouseleave(function() {
        if($window.scrollTop() >= 125 || $window.width() < 960) return;
        // console.log("mouseleave");
        $container.velocity("transition.fadeIn");
        $extra.find(".letter").velocity("stop").velocity("transition.slideDownOut", options);
    });
});

jQuery(function($) {
    $(".abb-skip-to-next").each(function() {
        var $this = $(this);
        $this.append($("<span>").addClass("pulse-dot"));
        $this.append($("<span>").addClass("pulse-dot1"));
        $this.append($("<span>").addClass("pulse-dot2"));
        $this.append($("<span>").addClass("pulse-dot3"));
        $this.append($("<span>").addClass("pulse-dot4"));
    });
});

jQuery(function($) {
    $('body').on('mouseenter', '.mk-love-this', function() {
        var $this = $(this);

        if ($this.hasClass('item-loved')) return false;
        if ($this.hasClass('item-inactive')) return false;

        var dontMove = $('<span>').addClass('dont-move').text("Don't Move!");

        $this.closest(".single-social-section").after(dontMove);

        // console.log("starting");
        $this.find("i").velocity(
            {
                scale: 1.4
            },
            {
                duration: 2000,
                complete: function() {
                    // console.log("liking");
                    $this.click();
                }
            });
    });

    $('body').on('mouseleave', '.mk-love-this', function() {
        var $this = $(this);

        if ($this.hasClass('item-loved')) return false;
        if ($this.hasClass('item-inactive')) return false;

        $('.dont-move').remove();
        $this.find("i").velocity("stop").velocity({scale: 1}, {duration: 500});
    });
});

jQuery(function ($) {
    $.fn.expandingBox = function () {
        this.each(function () {
            var $this = $(this);
            $this.addClass("expanding-box");
            var $button = $("<a class='read-more'>").text("Read More");
            $this.after($button);

            $this.css("position", "relative");
            $this.append($("<div class='fade'>"));

            var collapsedHeight = $this.data('collapsed-height') || 100;
            var originalHeight = $this.height();

            $button.click(function () {
                if ($this.hasClass("collapsed")) {
                    expand();
                } else {
                    collapse();
                }
            });

            collapse();

            function collapse() {
                $this.removeClass("expanded").addClass("collapsed").
                    animate({
                        height: collapsedHeight
                    }, 'fast', function () {
                        $button.text("Read More");
                    });

            }

            function expand() {
                $this.removeClass("collapsed").addClass("expanded")
                    .animate({
                        height: originalHeight
                    }, 'fast', function () {
                        $this.height('auto');
                        $button.text("Show Less");
                    });
            }
        });
    };

    $(".expanding-box").expandingBox();
});

jQuery(function($) {
    $.fn.stickyMenu = function() {
        this.each(function() {
            var $this = $(this);
            var $window = $(window);
            var $footer = $("#mk-footer");

            $window.scroll(function() {
                if(shouldBeFixed()) {
                    $this.addClass("fixed");
                } else {
                    $this.removeClass("fixed");
                }
            });

            function shouldBeFixed() {
                return $window.width() >= 960 &&
                    $window.scrollTop() >= 290; // &&
                // $this.height() + $window.scrollTop() + 40 < $footer.offset().top;
            }

            // $this.closest("#mk-sidebar").stick_in_parent();
        });
    };

    $(".widget_nav_menu, .widget-sub-navigation").stickyMenu();
});

jQuery(function($) {
    $(document).on("click", ".collapsing-box .open", function() {
        // console.log("CLICK .open");
        var $this = $(this);
        var scrollOffset = $this.closest(".collapsing-box").data("scroll-offset");
        $this.fadeOut(200, function() {
            $this.siblings('.close').show();
        });
        $this.siblings('.content').slideDown();
        if(scrollOffset) {
            $(window).scrollTo($this.siblings('.content'), 1000, {offset: +scrollOffset});
        }
    });

    $(document).on("click", ".collapsing-box .close", function() {
        // console.log("CLICK .close");
        var $this = $(this);
        $this.fadeOut(1000, function() {
            var $open = $this.siblings('.open');
            $open.find(".ripple-circle").remove();
            $open.show();
        });
        $this.siblings('.content').slideUp();
    });
});

jQuery(function ($) {
    var $projects = $("#projects");
    $projects.find(".project").hover(function () {
        $(this).addClass("active");
        $projects.addClass("active");
    }, function () {
        $(this).removeClass("active");
        $projects.removeClass("active");
    });
    var $scroll = $projects.closest(".scroll-projects");
    $scroll.addClass("first-slide");
    $("#projects-prev").click(function() {
        $scroll.removeClass("last-slide").addClass("first-slide");
        $scroll.animate({scrollLeft: 0}, "slow");
    });
    $("#projects-next").click(function() {
        $scroll.removeClass("first-slide").addClass("last-slide");
        var offset = $projects.width() - $projects.parent().width();
        $scroll.animate({scrollLeft: offset}, "slow");
    });
});

jQuery(function($) {
    $(".mk-portfolio-item").click(function(e) {
        e.preventDefault();
        $(this).find(".project-load").click();
    });
});

// Givlet Hack.
jQuery("a[href^='https://www.givlet']").addClass("on-checkout");

jQuery(function($) {
    $(".swiper-pagination-switch").each(function() {
        var $this = $(this);
        $this.find("a").text($this.index() + 1);
    });
});

jQuery(function($) {
    if($("body").hasClass("contact-us") && (/contactreq/.test(document.location))) {
        setTimeout(function() {
            $("#gform_wrapper_1").closest(".collapsing-box").children(".open").click();
        }, 1250);
    }
});

jQuery(function($) {
    if(!$("body").hasClass("home")) return;
    var referrer = document.referrer;
    if(!referrer) return;
    if( /ink.gd/.test(referrer) || /latikaroy.org/.test(referrer)) {
        $(window).scrollTo("#who-we-are");
    }
    //layered-popup pan vadlidation

});


jQuery(function($) {
    setInterval(function(){ $('.a-tag-line').removeClass('roll'); }, 1000);
     $('body').on('mouseover', '#ulp-layer-222 a', function() {
            $('#ulp-layer-222 a').attr('onclick','').unbind('click');
     });
     

     $('body').on('click', '#ulp-layer-222 a', function() { 
            $('#ulp-layer-222 a').attr('onclick','').unbind('click');
            var pan = $("#ulp-layer-257 input").val();
            var regpan = /^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/;
            if(regpan.test(pan) == false)
            {
                $("#ulp-layer-257 input").addClass("ulp-input-error");
                return false;
            }
            else
            {
                return ulp_subscribe(this);
            }
    });

     var  pan_check = function(){
            var pan = $("#ulp-layer-297 input").val();
            var regpan = /^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/;

            if(regpan.test(pan) == false)
            {
                $("#ulp-layer-297 input").addClass("ulp-input-error");
                return false;
            }
            else
            {
                return ulp_subscribe(this);
            }
     }

    $('body').on('keyup', '#ulp-layer-298 .ulp-input.ulp-input-field', function() {
        if ($(this).val()>=0){
            $('#ulp-layer-297').css("display","block");
            $('#ulp-layer-288 a').attr('onclick','').unbind('click');
            $('#ulp-layer-297').css("top","295px");
            $('#ulp-layer-296').css("top","335px");
            $('#ulp-layer-286,#ulp-layer-287').css("top","375px");
            $('#ulp-layer-292').css("top","415px");
            $('#ulp-layer-288').css("top","460px");
            $('#ulp-layer-291').css("height","515px");
     
         /* $('#ulp-layer-297 .ulp-input.ulp-input-field').prop('required',true);*/
        } else{ 

            $('#ulp-layer-297').css("display","none");
            $('#ulp-layer-297').css("top","255px");
            $('#ulp-layer-296').css("top","295px");
            $('#ulp-layer-286,#ulp-layer-287').css("top","335px");
            $('#ulp-layer-292').css("top","375px");
            $('#ulp-layer-288').css("top","420px");
            $('#ulp-layer-291').css("height","475px");
            $('#ulp-layer-288 a').click(function(){
                ulp_subscribe(this);
            });
        }
   }); 
     
     $('body').on('click', '#ulp-layer-288 a', function() {
        if($('#ulp-layer-298 .ulp-input.ulp-input-field').val()>=0){
           pan_check(); 
        }
     });
     
 });    

if(jQuery(window).width()<768){
	var hashstring=["We all have special needs","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better."];
}else{
	// Autism typer effect
	var hashstring=["We all have special needs","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better.","We all have special needs.<br>The sooner we learn it, the better."];
}


// variable to be used for checking which intro to load
var rand;

jQuery(window).bind("load", function($){
            if(jQuery('body').hasClass('home')){
                // nothing
            }else{
                return;
            }

            setTimeout(function(){
                jQuery('.autism-main-title p').addClass('aut-fadeIn');
            },1000);
            
            // Typer effect animation
            setTimeout(function(){
                var storedValueCheck = localStorage.getItem("storedValue");
                // console.log(storedValueCheck);
                if(storedValueCheck==null){
                    rand=0;
                }
                else if(storedValueCheck==0){
                    rand=1;
                }
                else if(storedValueCheck==1){
                    rand=2;
                    
                }
                else if(storedValueCheck==2){
                    rand=3;
                }
                else if(storedValueCheck==3){
                    rand=4;
                }
                else if(storedValueCheck==4){
                    rand=5;
                }
                else if(storedValueCheck==5){
                    rand=6;
                }
                else if(storedValueCheck==6){
                    rand=7;
                }
                else if(storedValueCheck==7){
                    rand=8;
                }
                else if(storedValueCheck==8){
                    rand=9;
                }
                else if(storedValueCheck==9){
                    rand=0;  
                }

                typer('.autism-sub-heading p')
                    .cursor({block: true, blink: 'hard', color: '#fff'})
                    .line(hashstring[0],40)
                    .pause(10)
                    .end(function(){
                         var whichElement=rand;
                        localStorage.setItem("storedValue", whichElement); 
                        jQuery('.autism-hashtags p').addClass('aut-fadeInUp');
                        jQuery('.autism-sub-heading').addClass('add-border');
                        setTimeout(function(){
                            jQuery('.autism-btn').addClass('aut-fadeInSmall');
                        },800);
                },true);

            },2600);

            
});

jQuery(function($){
	$('.autism-row').on('click',function(){
		var url = "https://resources.office.com/ww-landing-M365E-Global-Accessibility-Awareness-Day-video.html?lcid=en";
 		window.open(url, '_blank');
	});
});

// URL to Preselect Non-Indian Donate
jQuery(function($){
    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    if($('body').hasClass('donate-page')){
        var selectedOption = getParameterByName('select');
        if(selectedOption == 'nonindian'){
            jQuery("#input_3_1").val('non_indian');
            jQuery('#field_3_20').css('display','list-item');
            $(window).load(function(){
                $("html, body").delay(1000).animate({scrollTop: $('#donate-form').offset().top }, 1200);
            });
        }else if(selectedOption == 'indian'){
            jQuery("#input_3_1").val('indian');
            jQuery('#field_3_16').css('display','list-item');
            jQuery('#field_3_19').css('display','list-item');
            jQuery('#field_3_3').css('display','list-item');
            jQuery('#field_3_2').css('display','block');
            jQuery('#field_3_13').css('display','block');
            jQuery('#field_3_4').css('display','block');
            jQuery('#field_3_6').css('display','block');
            jQuery('#field_3_7').css('display','block');
            jQuery('#field_3_8').css('display','block');
            jQuery('#gform_submit_button_3').css('display','inline-block');

            $(window).load(function(){
                $("html, body").delay(1000).animate({scrollTop: $('#donate-form').offset().top }, 1200);
            });
            
        }  
    }
});

// Foobar JS

jQuery(function($){
    $('header .mk-header-holder').addClass('foobar-show');

    $('.foobar-close-button').on('click',function(){
        $('header .mk-header-holder').removeClass('foobar-show');
    });

    $('.foobar-open-button').on('click',function(){
        $('header .mk-header-holder').addClass('foobar-show');
    });

});

// Careers Page JS

jQuery(function($){
    $('body.careers .collapsing-box .open').on('click',function(){
        //Do nothing
    });

    $('body.careers .select-career-row .col.col-1 p').on('click',function(){
        var value1 = $('body.careers #input_7_32 option:nth-child(2)').attr('value');
        console.log(value1);

        $('body.careers .collapsing-box .open').trigger('click');
        $('body.careers #input_7_32').val(value1);
    });

    $('body.careers .select-career-row .col.col-2 p').on('click',function(){
        var value2 = $('body.careers #input_7_32 option:nth-child(3)').attr('value');
        console.log(value2);

        $('body.careers .collapsing-box .open').trigger('click');
        $('body.careers #input_7_32').val(value2);
    });

    $('body.careers .select-career-row .col.col-3 p').on('click',function(){
        var value3 = $('body.careers #input_7_32 option:nth-child(4)').attr('value');
        console.log(value3);

        $('body.careers .collapsing-box .open').trigger('click');
        $('body.careers #input_7_32').val(value3);
    });

});


jQuery(function($){
    if(!$('body').hasClass('home')){
        return;
    }

    // Default Option Select
    $('.custom-popup-container .toggle-section .toogle-nav .toogle-link.link-1').addClass('active');
    $('.custom-popup-container .toggle-section .toggle-content .content.content-1').addClass('active');

    // Toogle on Click Options
    $('.custom-popup-container .toggle-section .toogle-nav').on('click','.toogle-link',function(){
        var whichno = $(this).attr('data-no');

        // Remove active
        $('.custom-popup-container .toggle-section .toogle-nav .toogle-link').removeClass('active');
        $('.custom-popup-container .toggle-section .toggle-content .content').removeClass('active');

        // Add active
        $('.custom-popup-container .toggle-section .toogle-nav .toogle-link.link-'+whichno).addClass('active');
        $('.custom-popup-container .toggle-section .toggle-content .content-'+whichno).addClass('active');
    });


    $(window).load(function() {
      // Run code
      setTimeout(function(){
        $('body .custom-popup-container').removeClass('hidethis');
      },5000);

      setTimeout(function(){
        $('body .custom-popup-container').addClass('active-popup');
      },5100);
      
      $('body .custom-popup-container .custom-popup').on('click','.custom-popup-close',function(){
        $('body .custom-popup-container').removeClass('active-popup');
        setTimeout(function(){
            $('body .custom-popup-container').addClass('hidethis');
        },500);
      });

      $('body .custom-popup-container').on('click','.custom-popup-overlay',function(){
        $('body .custom-popup-container').removeClass('active-popup');
        setTimeout(function(){
            $('body .custom-popup-container').addClass('hidethis');
        },500);
      });

    });

});


// jQuery('html').attr('lang','en');
// jQuery('meta[name=viewport]').attr('content','width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=0');

// Resources Tab Show  Click
jQuery(function($){
    $('body header .menu-item-has-children.has-mega-menu > ul.sub-menu li.menu-item').on('click','.megamenu-title',function(){
        $(this).parent().find('ul.sub-menu').toggleClass('active');
    });
});

// Razorpay JS
jQuery(function($){
    if(!$('body.donate-page .razorpay-container').length){
        return;
    }

   $('body.donate-page .razorpay-container').appendTo('.gform_confirmation_wrapper')

});

// Donate Popup JS
jQuery(function($){
    if($('body.home .custom-video-popup-container').length == 0){
        return;
    }

    // Helper function
    let domReady = (cb) => {
        document.readyState === 'interactive' || document.readyState === 'complete'
            ? cb()
            : document.addEventListener('DOMContentLoaded', cb);
    };

    domReady(() => {
        setTimeout(function(){
            $('.custom-video-popup-container').addClass('active');
        }, 2000);
    });

    $('.custom-video-popup-container .popup-main-content .popup-close').on('click', function(event){
        event.preventDefault();
        event.stopPropagation();
        // $('.custom-video-popup-container .popup-main-content video').trigger('pause');
        // $('.custom-video-popup-container .popup-main-content video').get(0).currentTime = 0;
        $('.custom-video-popup-container').removeClass('active');
    });
});

console.log("");
console.log('%c MADE IN THE MOUNTAINS BY ', 'font-weight: bold; font-size: 24px;color: #151515;');
console.log('%c SIDDATWORK ', 'font-weight: bold; font-size: 50px;color: #151515;  border:5px solid #151515'); 